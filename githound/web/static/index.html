<!DOCTYPE html>
<html lang="en" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>GitHound - Advanced Git History Search</title>
    <meta name="description" content="Advanced Git repository search with multi-modal capabilities" />

    <!-- Preconnect to external resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-9ndCyUa6c+yl9KvkqWn6+3UOEJfgm6ddd6ZgMAr1rHyoQFNy+8dNdxjbyeVd4+BL"
      crossorigin="anonymous"
    />

    <!-- Font Awesome -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
      integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
      crossorigin="anonymous"
    />

    <!-- Highlight.js for code syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" media="(prefers-color-scheme: dark)">

    <!-- Custom CSS -->
    <link href="style.css" rel="stylesheet" />
  </head>
  <body>
    <!-- Theme Toggle Button -->
    <button type="button" class="theme-toggle" id="themeToggle" title="Toggle theme">
      <i class="fas fa-moon" id="themeIcon"></i>
    </button>

    <!-- Connection Status Indicator will be created dynamically by JavaScript -->

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg" data-testid="desktop-navigation">
      <div class="container">
        <span class="navbar-brand mb-0 h1">
          <i class="fas fa-dog"></i> GitHound
        </span>
        <span class="navbar-text d-none d-lg-inline">
          <i class="fas fa-search me-2"></i>Advanced Git History Search
        </span>

        <!-- Mobile Menu Button -->
        <button class="navbar-toggler d-lg-none" type="button" data-bs-toggle="collapse" data-bs-target="#mobileMenu" aria-controls="mobileMenu" aria-expanded="false" aria-label="Toggle navigation" data-testid="mobile-menu-button">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="navbar-nav ms-auto d-none d-lg-flex">
          <!-- Authentication buttons (will be shown/hidden by JavaScript) -->
          <button type="button" class="btn btn-outline-light btn-sm me-2" data-testid="login-button" onclick="showLoginModal()" style="display: none;">
            <i class="fas fa-sign-in-alt"></i> Login
          </button>
          <button type="button" class="btn btn-outline-light btn-sm me-2" data-testid="register-button" onclick="showRegisterModal()" style="display: none;">
            <i class="fas fa-user-plus"></i> Register
          </button>
          <!-- User menu (will be shown when logged in) -->
          <div class="dropdown" data-testid="user-menu" style="display: none;">
            <button class="btn btn-outline-light btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">
              <i class="fas fa-user"></i> <span data-testid="username-display">User</span>
            </button>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="#" data-testid="profile-link" onclick="showProfile()"><i class="fas fa-user-cog"></i> Profile</a></li>
              <li><a class="dropdown-item" href="#" data-testid="admin-panel-link" onclick="showAdminPanel()" style="display: none;"><i class="fas fa-shield-alt"></i> Admin Panel</a></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="#" data-testid="logout-button" onclick="logout()"><i class="fas fa-sign-out-alt"></i> Logout</a></li>
            </ul>
          </div>
          <button type="button" class="btn btn-outline-light btn-sm" onclick="showHelp()">
            <i class="fas fa-question-circle"></i> Help
          </button>
        </div>

        <!-- Mobile Menu -->
        <div class="collapse navbar-collapse d-lg-none" id="mobileMenu" data-testid="mobile-menu">
          <div class="navbar-nav">
            <div class="nav-item" id="mobileUserMenuContainer" style="display: none;">
              <a class="nav-link" href="#" data-testid="mobile-profile-link" onclick="showProfile()">
                <i class="fas fa-user"></i> Profile
              </a>
              <a class="nav-link" href="#" data-testid="mobile-admin-link" onclick="showAdminPanel()" style="display: none;">
                <i class="fas fa-cog"></i> Admin Panel
              </a>
              <a class="nav-link" href="#" data-testid="mobile-logout-link" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> Logout
              </a>
            </div>
            <div id="mobileAuthButtons">
              <a class="nav-link" href="#" data-testid="mobile-login-button" onclick="showLoginModal()">
                <i class="fas fa-sign-in-alt"></i> Login
              </a>
              <a class="nav-link" href="#" data-testid="mobile-register-button" onclick="showRegisterModal()">
                <i class="fas fa-user-plus"></i> Register
              </a>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <div class="container mt-4" data-testid="main-container">
      <!-- Dashboard Section -->
      <div class="row mb-4">
        <div class="col-md-3">
          <div class="card glass fade-in-up">
            <div class="card-body text-center">
              <i class="fas fa-search fa-2x text-primary mb-2"></i>
              <h6 class="card-title">Total Searches</h6>
              <h4 class="gradient-text" id="totalSearches">0</h4>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card glass fade-in-up animation-delay-1">
            <div class="card-body text-center">
              <i class="fas fa-clock fa-2x text-info mb-2"></i>
              <h6 class="card-title">Active Searches</h6>
              <h4 class="gradient-text" id="activeSearches">0</h4>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card glass fade-in-up animation-delay-2">
            <div class="card-body text-center">
              <i class="fas fa-file-code fa-2x text-success mb-2"></i>
              <h6 class="card-title">Results Found</h6>
              <h4 class="gradient-text" id="totalResults">0</h4>
            </div>
          </div>
        </div>
        <div class="col-md-3">
          <div class="card glass fade-in-up animation-delay-3">
            <div class="card-body text-center">
              <i class="fas fa-history fa-2x text-warning mb-2"></i>
              <h6 class="card-title">Last Search</h6>
              <small class="text-muted" id="lastSearchTime">Never</small>
            </div>
          </div>
        </div>
      </div>

      <!-- Quick Actions -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-bolt"></i> Quick Actions
              </h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-3 mb-2">
                  <button type="button" class="btn btn-outline-primary w-100" onclick="loadSearchTemplate('recent-commits')">
                    <i class="fas fa-clock"></i> Recent Commits
                  </button>
                </div>
                <div class="col-md-3 mb-2">
                  <button type="button" class="btn btn-outline-success w-100" onclick="loadSearchTemplate('bug-fixes')">
                    <i class="fas fa-bug"></i> Bug Fixes
                  </button>
                </div>
                <div class="col-md-3 mb-2">
                  <button type="button" class="btn btn-outline-info w-100" onclick="loadSearchTemplate('code-changes')">
                    <i class="fas fa-code"></i> Code Changes
                  </button>
                </div>
                <div class="col-md-3 mb-2">
                  <button type="button" class="btn btn-outline-warning w-100" onclick="showSearchHistory()">
                    <i class="fas fa-history"></i> Search History
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Search Form -->
      <div class="card mb-4 fade-in-up">
        <div class="card-header">
          <div class="d-flex justify-content-between align-items-center">
            <h5 class="mb-0">
              <i class="fas fa-search"></i> Search Configuration
            </h5>
            <div class="btn-group btn-group-sm">
              <button type="button" class="btn btn-outline-secondary" onclick="saveSearchTemplate()">
                <i class="fas fa-save"></i> Save Template
              </button>
              <button type="button" class="btn btn-outline-secondary" onclick="loadSearchTemplate()">
                <i class="fas fa-folder-open"></i> Load Template
              </button>
              <button type="button" class="btn btn-outline-secondary" onclick="clearForm()">
                <i class="fas fa-eraser"></i> Clear
              </button>
            </div>
          </div>
        </div>
        <div class="card-body">
          <form id="searchForm" data-testid="search-form">
            <!-- Repository Path -->
            <div class="row mb-3">
              <div class="col-md-6">
                <label for="repoPath" class="form-label"
                  >Repository Path *</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="repoPath"
                  data-testid="repo-path-input"
                  required
                  placeholder="/path/to/git/repository"
                  value="."
                />
                <div class="invalid-feedback" data-testid="repo-path-error"></div>
              </div>
              <div class="col-md-6">
                <label for="branch" class="form-label">Branch</label>
                <input
                  type="text"
                  class="form-control"
                  id="branch"
                  data-testid="branch-input"
                  placeholder="main (leave empty for current branch)"
                />
              </div>
            </div>

            <!-- Search Criteria Tabs -->
            <ul class="nav nav-tabs" id="searchTabs" role="tablist">
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link active"
                  id="content-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#content"
                  data-testid="content-search-tab"
                  type="button"
                  role="tab"
                >
                  <i class="fas fa-file-alt"></i> Content
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link"
                  id="commit-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#commit"
                  data-testid="commit-search-tab"
                  type="button"
                  role="tab"
                >
                  <i class="fas fa-code-branch"></i> Commit
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link"
                  id="files-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#files"
                  data-testid="files-search-tab"
                  type="button"
                  role="tab"
                >
                  <i class="fas fa-folder"></i> Files
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link"
                  id="advanced-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#advanced"
                  data-testid="advanced-search-tab"
                  type="button"
                  role="tab"
                >
                  <i class="fas fa-cogs"></i> Advanced
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link"
                  id="fuzzy-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#fuzzy"
                  data-testid="fuzzy-search-tab"
                  type="button"
                  role="tab"
                >
                  <i class="fas fa-search-plus"></i> Fuzzy
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link"
                  id="historical-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#historical"
                  data-testid="historical-search-tab"
                  type="button"
                  role="tab"
                >
                  <i class="fas fa-history"></i> Historical
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link"
                  id="filters-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#filters"
                  data-testid="filters-tab"
                  type="button"
                  role="tab"
                >
                  <i class="fas fa-filter"></i> Filters
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button
                  class="nav-link"
                  id="history-tab"
                  data-bs-toggle="tab"
                  data-bs-target="#history"
                  data-testid="search-history-tab"
                  type="button"
                  role="tab"
                >
                  <i class="fas fa-clock"></i> History
                </button>
              </li>
            </ul>

            <div class="tab-content mt-3" id="searchTabContent">
              <!-- Content Search -->
              <div
                class="tab-pane fade show active"
                id="content"
                role="tabpanel"
              >
                <div class="row">
                  <div class="col-md-8">
                    <label for="contentPattern" class="form-label"
                      >Content Pattern</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="contentPattern"
                      data-testid="search-query-input"
                      placeholder="Regular expression or text to search for"
                    />
                    <div class="invalid-feedback" data-testid="query-error"></div>
                  </div>
                  <div class="col-md-4">
                    <label class="form-label">&nbsp;</label>
                    <div class="form-check">
                      <input
                        class="form-check-input"
                        type="checkbox"
                        id="caseSensitive"
                        data-testid="case-sensitive-checkbox"
                      />
                      <label class="form-check-label" for="caseSensitive">
                        Case Sensitive
                      </label>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Commit Search -->
              <div class="tab-pane fade" id="commit" role="tabpanel">
                <div class="row mb-3">
                  <div class="col-md-6">
                    <label for="commitHash" class="form-label"
                      >Commit Hash</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="commitHash"
                      placeholder="Full or partial commit hash"
                    />
                  </div>
                  <div class="col-md-6">
                    <label for="authorPattern" class="form-label">Author</label>
                    <input
                      type="text"
                      class="form-control"
                      id="authorPattern"
                      placeholder="Author name or email"
                    />
                  </div>
                </div>
                <div class="row mb-3">
                  <div class="col-md-12">
                    <label for="messagePattern" class="form-label"
                      >Commit Message</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="messagePattern"
                      placeholder="Search in commit messages"
                    />
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <label for="dateFrom" class="form-label">Date From</label>
                    <input type="date" class="form-control" id="dateFrom" />
                  </div>
                  <div class="col-md-6">
                    <label for="dateTo" class="form-label">Date To</label>
                    <input type="date" class="form-control" id="dateTo" />
                  </div>
                </div>
              </div>

              <!-- File Search -->
              <div class="tab-pane fade" id="files" role="tabpanel">
                <div class="row mb-3">
                  <div class="col-md-6">
                    <label for="filePathPattern" class="form-label"
                      >File Path Pattern</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="filePathPattern"
                      placeholder="e.g., *.py or src/**/*.js"
                    />
                  </div>
                  <div class="col-md-6">
                    <label for="fileExtensions" class="form-label"
                      >File Extensions</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="fileExtensions"
                      placeholder="py,js,java (comma-separated)"
                    />
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <label for="includeGlobs" class="form-label"
                      >Include Patterns</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="includeGlobs"
                      placeholder="src/**,tests/** (comma-separated)"
                    />
                  </div>
                  <div class="col-md-6">
                    <label for="excludeGlobs" class="form-label"
                      >Exclude Patterns</label
                    >
                    <input
                      type="text"
                      class="form-control"
                      id="excludeGlobs"
                      placeholder="node_modules/**,*.log (comma-separated)"
                    />
                  </div>
                </div>
              </div>

              <!-- Advanced Options -->
              <div class="tab-pane fade" id="advanced" role="tabpanel">
                <div class="row mb-3">
                  <div class="col-md-4">
                    <div class="form-check">
                      <input
                        class="form-check-input"
                        type="checkbox"
                        id="fuzzySearch"
                      />
                      <label class="form-check-label" for="fuzzySearch">
                        Enable Fuzzy Search
                      </label>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <label for="fuzzyThreshold" class="form-label"
                      >Fuzzy Threshold</label
                    >
                    <input
                      type="range"
                      class="form-range"
                      id="fuzzyThreshold"
                      min="0"
                      max="1"
                      step="0.1"
                      value="0.8"
                    />
                    <small class="text-muted"
                      >Current: <span id="fuzzyThresholdValue">0.8</span></small
                    >
                  </div>
                  <div class="col-md-4">
                    <label for="maxResults" class="form-label"
                      >Max Results</label
                    >
                    <input
                      type="number"
                      class="form-control"
                      id="maxResults"
                      placeholder="1000"
                      min="1"
                      max="10000"
                    />
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <label for="maxFileSize" class="form-label"
                      >Max File Size (bytes)</label
                    >
                    <input
                      type="number"
                      class="form-control"
                      id="maxFileSize"
                      placeholder="10485760 (10MB)"
                    />
                  </div>
                  <div class="col-md-6">
                    <label for="timeoutSeconds" class="form-label"
                      >Timeout (seconds)</label
                    >
                    <input
                      type="number"
                      class="form-control"
                      id="timeoutSeconds"
                      value="300"
                      min="10"
                      max="3600"
                    />
                  </div>
                </div>
              </div>

              <!-- Fuzzy Search -->
              <div class="tab-pane fade" id="fuzzy" role="tabpanel">
                <div class="row">
                  <div class="col-md-8">
                    <label for="fuzzyQuery" class="form-label">Fuzzy Search Query</label>
                    <input
                      type="text"
                      class="form-control"
                      id="fuzzyQuery"
                      data-testid="fuzzy-query-input"
                      placeholder="Search with typos and approximate matches"
                    />
                  </div>
                  <div class="col-md-4">
                    <label for="fuzzyThresholdInput" class="form-label">Fuzzy Threshold</label>
                    <input
                      type="number"
                      class="form-control"
                      id="fuzzyThresholdInput"
                      data-testid="fuzzy-threshold"
                      min="0"
                      max="1"
                      step="0.1"
                      value="0.8"
                      placeholder="0.8"
                    />
                  </div>
                </div>
              </div>

              <!-- Historical Search -->
              <div class="tab-pane fade" id="historical" role="tabpanel">
                <div class="row">
                  <div class="col-md-6">
                    <label for="historicalDateFrom" class="form-label">From Date</label>
                    <input
                      type="date"
                      class="form-control"
                      id="historicalDateFrom"
                      data-testid="historical-date-from"
                    />
                  </div>
                  <div class="col-md-6">
                    <label for="historicalDateTo" class="form-label">To Date</label>
                    <input
                      type="date"
                      class="form-control"
                      id="historicalDateTo"
                      data-testid="historical-date-to"
                    />
                  </div>
                </div>
                <div class="row mt-3">
                  <div class="col-md-12">
                    <label for="historicalQuery" class="form-label">Historical Query</label>
                    <input
                      type="text"
                      class="form-control"
                      id="historicalQuery"
                      data-testid="historical-query-input"
                      placeholder="Search in historical commits"
                    />
                  </div>
                </div>
              </div>

              <!-- Filters -->
              <div class="tab-pane fade" id="filters" role="tabpanel">
                <div class="row">
                  <div class="col-md-6">
                    <label class="form-label">File Types</label>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="fileTypePy" data-testid="file-type-py">
                      <label class="form-check-label" for="fileTypePy">Python (.py)</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="fileTypeJs" data-testid="file-type-js">
                      <label class="form-check-label" for="fileTypeJs">JavaScript (.js)</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="fileTypeJava" data-testid="file-type-java">
                      <label class="form-check-label" for="fileTypeJava">Java (.java)</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="fileTypeCpp" data-testid="file-type-cpp">
                      <label class="form-check-label" for="fileTypeCpp">C++ (.cpp)</label>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <label for="authorFilter" class="form-label">Author Filter</label>
                    <input
                      type="text"
                      class="form-control"
                      id="authorFilter"
                      data-testid="author-filter"
                      placeholder="Filter by author email or name"
                    />
                    <label for="maxResultsFilter" class="form-label mt-3">Max Results</label>
                    <input
                      type="number"
                      class="form-control"
                      id="maxResultsFilter"
                      data-testid="max-results"
                      min="1"
                      max="1000"
                      value="100"
                    />
                  </div>
                </div>
              </div>

              <!-- Search History -->
              <div class="tab-pane fade" id="history" role="tabpanel">
                <div class="mt-3">
                  <h6>Recent Searches</h6>
                  <div id="searchHistoryContainer" data-testid="search-history-container">
                    <p class="text-muted">No search history available.</p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Search Button -->
            <div class="row mt-4">
              <div class="col-12">
                <button
                  type="submit"
                  class="btn btn-primary btn-lg"
                  id="searchButton"
                  data-testid="submit-search"
                >
                  <i class="fas fa-search"></i> Start Search
                </button>
                <button
                  type="button"
                  class="btn btn-secondary btn-lg ms-2 d-none"
                  id="cancelButton"
                  data-testid="cancel-search"
                >
                  <i class="fas fa-stop"></i> Cancel Search
                </button>
              </div>
            </div>
          </form>
        </div>
      </div>

      <!-- Progress Section -->
      <div class="card mb-4 d-none" id="progressCard" data-testid="search-progress">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="fas fa-spinner fa-spin"></i> Search Progress
          </h5>
        </div>
        <div class="card-body">
          <div class="progress mb-3">
            <div
              class="progress-bar progress-bar-striped progress-bar-animated progress-bar-initial"
              id="progressBar"
              data-testid="progress-bar"
              role="progressbar"
              aria-valuenow="0"
              aria-valuemin="0"
              aria-valuemax="100"
              aria-label="Search progress"
            ></div>
          </div>
          <div id="progressMessage" class="text-muted" data-testid="progress-message">
            Initializing search...
          </div>
          <div class="row mt-3">
            <div class="col-md-3">
              <small class="text-muted"
                >Results Found: <span id="resultsCount" data-testid="results-count">0</span></small
              >
            </div>
            <div class="col-md-3">
              <small class="text-muted"
                >Status: <span id="searchStatus" data-testid="search-status">Starting</span></small
              >
            </div>
            <div class="col-md-3">
              <small class="text-muted"
                >Type: <span id="searchType" data-testid="search-type-indicator">Content Search</span></small
              >
            </div>
            <div class="col-md-3">
              <small class="text-muted"
                >Search ID: <span id="searchId" data-testid="search-id">-</span></small
              >
            </div>
          </div>
        </div>
      </div>

      <!-- Results Section -->
      <div class="card d-none" id="resultsCard" data-testid="search-results">
        <div
          class="card-header d-flex justify-content-between align-items-center"
        >
          <h5 class="mb-0"><i class="fas fa-list"></i> Search Results</h5>
          <div class="btn-group" role="group">
            <button
              type="button"
              class="btn btn-outline-primary btn-sm"
              id="exportJson"
              data-testid="export-json"
            >
              <i class="fas fa-download"></i> JSON
            </button>
            <button
              type="button"
              class="btn btn-outline-primary btn-sm"
              id="exportCsv"
              data-testid="export-csv"
            >
              <i class="fas fa-download"></i> CSV
            </button>
            <button
              type="button"
              class="btn btn-outline-success btn-sm"
              data-bs-toggle="modal"
              data-bs-target="#exportModal"
              data-testid="export-button"
            >
              <i class="fas fa-cog"></i> Advanced Export
            </button>
          </div>
        </div>
        <div class="card-body">
          <div id="resultsContainer" data-testid="results-container">
            <!-- Results will be populated here -->
          </div>

          <!-- Pagination -->
          <nav aria-label="Search results pagination" data-testid="pagination" style="display: none;">
            <ul class="pagination justify-content-center">
              <li class="page-item">
                <a class="page-link" href="#" data-testid="prev-page">Previous</a>
              </li>
              <li class="page-item active">
                <span class="page-link" data-testid="current-page">1</span>
              </li>
              <li class="page-item">
                <a class="page-link" href="#" data-testid="next-page">Next</a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>

    <!-- Authentication Modals -->
    <!-- Login Modal -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="loginModalLabel">Login to GitHound</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="loginForm" data-testid="login-form">
              <div class="mb-3">
                <label for="loginUsername" class="form-label">Username</label>
                <input type="text" class="form-control" id="loginUsername" data-testid="username-input" required aria-required="true" aria-describedby="login-username-error">
                <div class="invalid-feedback" data-testid="username-error" id="login-username-error"></div>
              </div>
              <div class="mb-3">
                <label for="loginPassword" class="form-label">Password</label>
                <input type="password" class="form-control" id="loginPassword" data-testid="password-input" required aria-required="true" aria-describedby="login-password-error">
                <div class="invalid-feedback" data-testid="password-error" id="login-password-error"></div>
              </div>
              <div class="alert alert-danger d-none" data-testid="login-error" role="alert">
                Invalid username or password
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-primary" data-testid="submit-login" form="loginForm">Login</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Registration Modal -->
    <div class="modal fade" id="registerModal" tabindex="-1" aria-labelledby="registerModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="registerModalLabel">Register for GitHound</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="registerForm" data-testid="registration-form">
              <div class="mb-3">
                <label for="registerUsername" class="form-label">Username</label>
                <input type="text" class="form-control" id="registerUsername" data-testid="register-username" required aria-required="true" aria-describedby="username-error">
                <div class="invalid-feedback" data-testid="username-error" id="username-error"></div>
              </div>
              <div class="mb-3">
                <label for="registerEmail" class="form-label">Email</label>
                <input type="email" class="form-control" id="registerEmail" data-testid="register-email" required aria-required="true" aria-describedby="email-error">
                <div class="invalid-feedback" data-testid="email-error" id="email-error"></div>
              </div>
              <div class="mb-3">
                <label for="registerPassword" class="form-label">Password</label>
                <input type="password" class="form-control" id="registerPassword" data-testid="register-password" required aria-required="true" aria-describedby="password-error">
                <div class="invalid-feedback" data-testid="password-error" id="password-error"></div>
              </div>
              <div class="mb-3">
                <label for="registerConfirmPassword" class="form-label">Confirm Password</label>
                <input type="password" class="form-control" id="registerConfirmPassword" data-testid="register-confirm-password" required aria-required="true" aria-describedby="confirm-password-error">
                <div class="invalid-feedback" data-testid="password-mismatch-error" id="confirm-password-error"></div>
              </div>
              <div class="alert alert-success d-none" data-testid="registration-success" role="alert">
                Registration successful! You can now login.
              </div>
              <div class="alert alert-danger d-none" data-testid="registration-error" role="alert">
                Registration failed. Please try again.
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-primary" data-testid="submit-registration" form="registerForm">Register</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Error/Success Messages -->
    <div class="position-fixed top-0 end-0 p-3" style="z-index: 11">
      <div id="liveToast" class="toast hide" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
          <strong class="me-auto" id="toastTitle">GitHound</strong>
          <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body" id="toastMessage">
          <!-- Toast message will be inserted here -->
        </div>
      </div>
    </div>

    <!-- Search cancelled message -->
    <div class="alert alert-warning d-none" data-testid="search-cancelled" role="alert">
      Search was cancelled.
    </div>

    <!-- Search error message -->
    <div class="alert alert-danger d-none" data-testid="search-error" role="alert">
      An error occurred during search.
    </div>

    <!-- Profile Modal -->
    <div class="modal fade" id="profileModal" tabindex="-1" aria-labelledby="profileModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="profileModalLabel">User Profile</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <!-- Profile tabs -->
            <ul class="nav nav-tabs" id="profileTabs" role="tablist">
              <li class="nav-item" role="presentation">
                <button class="nav-link active" id="profile-info-tab" data-bs-toggle="tab" data-bs-target="#profile-info" type="button" role="tab">
                  Profile Info
                </button>
              </li>
              <li class="nav-item" role="presentation">
                <button class="nav-link" id="change-password-tab" data-testid="change-password-tab" data-bs-toggle="tab" data-bs-target="#change-password" type="button" role="tab">
                  Change Password
                </button>
              </li>
            </ul>

            <div class="tab-content" id="profileTabContent">
              <!-- Profile Info Tab -->
              <div class="tab-pane fade show active" id="profile-info" role="tabpanel">
                <div class="mt-3">
                  <div class="mb-3">
                    <label class="form-label">Username</label>
                    <input type="text" class="form-control" id="profileUsername" readonly>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Email</label>
                    <input type="email" class="form-control" id="profileEmail" readonly>
                  </div>
                  <div class="mb-3">
                    <label class="form-label">Role</label>
                    <input type="text" class="form-control" id="profileRole" readonly>
                  </div>
                </div>
              </div>

              <!-- Change Password Tab -->
              <div class="tab-pane fade" id="change-password" role="tabpanel">
                <div class="mt-3">
                  <form id="changePasswordForm">
                    <div class="mb-3">
                      <label for="currentPassword" class="form-label">Current Password</label>
                      <input type="password" class="form-control" id="currentPassword" data-testid="current-password" required>
                      <div class="invalid-feedback" data-testid="current-password-error"></div>
                    </div>
                    <div class="mb-3">
                      <label for="newPassword" class="form-label">New Password</label>
                      <input type="password" class="form-control" id="newPassword" data-testid="new-password" required>
                      <div class="invalid-feedback" data-testid="new-password-error"></div>
                    </div>
                    <div class="mb-3">
                      <label for="confirmNewPassword" class="form-label">Confirm New Password</label>
                      <input type="password" class="form-control" id="confirmNewPassword" data-testid="confirm-new-password" required>
                      <div class="invalid-feedback" data-testid="confirm-new-password-error"></div>
                    </div>
                    <div class="alert alert-success d-none" data-testid="password-change-success" role="alert">
                      Password changed successfully!
                    </div>
                    <div class="alert alert-danger d-none" data-testid="password-change-error" role="alert">
                      Failed to change password. Please try again.
                    </div>
                  </form>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="submit" class="btn btn-primary" data-testid="submit-password-change" form="changePasswordForm" style="display: none;">
              Change Password
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Admin Panel Modal -->
    <div class="modal fade" id="adminModal" tabindex="-1" aria-labelledby="adminModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-xl">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="adminModalLabel">Admin Panel</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div data-testid="admin-dashboard">
              <h6>Admin Dashboard</h6>
              <div class="row">
                <div class="col-md-6">
                  <div class="card">
                    <div class="card-header">
                      <h6 data-testid="user-management">User Management</h6>
                    </div>
                    <div class="card-body">
                      <p>Manage users, roles, and permissions.</p>
                      <button class="btn btn-primary btn-sm">Manage Users</button>
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="card">
                    <div class="card-header">
                      <h6>System Settings</h6>
                    </div>
                    <div class="card-body">
                      <p>Configure system-wide settings.</p>
                      <button class="btn btn-primary btn-sm">Settings</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Export Modal -->
    <div class="modal fade" id="exportModal" tabindex="-1" aria-labelledby="exportModalLabel" aria-hidden="true" data-testid="export-modal">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exportModalLabel">Export Search Results</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="exportForm" data-testid="export-form">
              <!-- Format Selection -->
              <div class="mb-3">
                <label for="exportFormat" class="form-label">Export Format</label>
                <select class="form-select" id="exportFormat" data-testid="export-format">
                  <option value="json" data-testid="format-json">JSON</option>
                  <option value="csv" data-testid="format-csv">CSV</option>
                  <option value="yaml" data-testid="format-yaml">YAML</option>
                  <option value="xml" data-testid="format-xml">XML</option>
                </select>
              </div>

              <!-- Export Options -->
              <div class="mb-3">
                <label class="form-label">Export Options</label>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="includeMetadata" data-testid="include-metadata" checked>
                  <label class="form-check-label" for="includeMetadata">Include Metadata</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="includeCommitInfo" data-testid="include-commit-info" checked>
                  <label class="form-check-label" for="includeCommitInfo">Include Commit Information</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="includeFileContent" data-testid="include-file-content">
                  <label class="form-check-label" for="includeFileContent">Include File Content</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="compressOutput" data-testid="compress-output">
                  <label class="form-check-label" for="compressOutput">Compress Output</label>
                </div>
              </div>

              <!-- Field Selection -->
              <div class="mb-3" data-testid="field-selection">
                <label class="form-label">Fields to Include</label>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="selectAllFields" data-testid="select-all-fields" checked>
                  <label class="form-check-label" for="selectAllFields">Select All Fields</label>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="fieldFilePath" data-testid="field-file-path" checked>
                      <label class="form-check-label" for="fieldFilePath">File Path</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="fieldLineNumber" data-testid="field-line-number" checked>
                      <label class="form-check-label" for="fieldLineNumber">Line Number</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="fieldContent" data-testid="field-content" checked>
                      <label class="form-check-label" for="fieldContent">Content</label>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="fieldAuthor" data-testid="field-author" checked>
                      <label class="form-check-label" for="fieldAuthor">Author</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="fieldCommitHash" data-testid="field-commit-hash" checked>
                      <label class="form-check-label" for="fieldCommitHash">Commit Hash</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="fieldCommitDate" data-testid="field-commit-date" checked>
                      <label class="form-check-label" for="fieldCommitDate">Commit Date</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="checkbox" id="fieldCommitMessage" data-testid="field-commit-message" checked>
                      <label class="form-check-label" for="fieldCommitMessage">Commit Message</label>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Filename -->
              <div class="mb-3">
                <label for="exportFilename" class="form-label">Filename</label>
                <div class="input-group">
                  <input type="text" class="form-control" id="exportFilename" data-testid="export-filename" placeholder="search-results">
                  <button class="btn btn-outline-secondary" type="button" data-testid="generate-filename">Generate</button>
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" data-testid="cancel-export">Cancel</button>
            <button type="button" class="btn btn-primary" data-testid="confirm-export">Export</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap JS -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
      crossorigin="anonymous">
    </script>

    <!-- Highlight.js for syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/java.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/cpp.min.js"></script>

    <!-- Custom JS -->
    <script src="app.js"></script>
  </body>
</html>
